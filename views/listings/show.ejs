<%layout("../layouts/boilerplate.ejs")%>

<body>
  <div class="row mt-2">
    <div class="col-8 offset-3">
      <h1><%= listing.title %></h1>
    </div>
    <div class="card col-6 offset-4" style="width: 20rem">
      <img
        class="card-img-top showImg"
        src="<%=listing.image.url%>"
        alt="%= listing.image.filename %>"
      />
      <div class="card-body">
        <h5 class="card-title"><%= listing.image.filename %></h5>
        <p class="card-text">
          <%=listing.description%> <br />
          &#8377; <%= listing.price.toLocaleString('en-IN') %> <br />
          <%= listing.location %> <br />
          <%= listing.country %>
        </p>
      </div>
    </div>
    <h3>Reviews</h3>
    <div class="reviewContainer">
      <% for(const rating of listing.review){%>
      <div class="reviewDiv">
        <%=rating.rating%> | <%=rating.review%>
        <p><strong>At: </strong><%=rating.time.toDateString()%></p>
      </div>
      <hr />
      <%}%>
    </div>
    <div class="row mt-2 show-btns">
      <div class="">
        <form action="/edit" method="post">
          <input type="hidden" name="id" value="<%=listing._id%>" />
          <button class="btn btn-warning" type="submit">Edit your post</button>
        </form>
      </div>
      <div class="">
        <form action="/listing/<%=listing._id%>?_method=delete" method="post">
          <button class="btn btn-danger" type="submit">Delete</button>
        </form>
        <div class="">
          <form action="/listing-review" method="post">
            <input type="hidden" name="listingId" value="<%=listing._id%>" />
            <button class="btn btn-success" type="submit">Submit Review</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</body>
